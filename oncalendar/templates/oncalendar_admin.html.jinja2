<!DOCTYPE html>
<html>
  <head>
    <title>Box On-Call Calendar Administration</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" type="text/css" href="{{ stylesheet_url }}" />
    <script src="{{ jquery_url }}"></script>
    <script src="{{ datejs_url }}"></script>
    <script src="{{ bootstrapjs_url }}"></script>
    <script src="{{ magnific_url }}"></script>
    <script src="{{ datatables_url }}"></script>
    <script src="{{ ocjs_url }}"></script>
    <script src="{{ ocadminjs_url }}"></script>
	<script src="{{ colorwheel_url }}"></script>
  </head>

  <body>
    <div id="admin-title" class="page-title">
      <div id="title"><h2>Box On-Call Calendar Administration</h2></div>
      <div id="user-menu" class="admin-user-menu dropdown">
        <span id="username" data-toggle="dropdown">{{ g.user.username }}</span>
        <span class="input-menu elegant_icons arrow_carrot-down" data-toggle="dropdown"> </span>
        <ul id="user-dropdown" class="dropdown-menu" role="menu">
          <li><a href="/logout"><span id="user-logout">Logout</span></a></li>
          <li><a href="/"><span id="calendar-link">Back to Calendar</span></a></li>
        </ul>
      </div>
    </div>
    <div id="admin-console" class="outer-container">
      <div id="console-box" class="inner-container">
        <ul id="admin-functions" class="tablist">
          <li id="config-tab" class="tab" data-target="config-panel">
            Configuration
          </li><li id="groups-tab" class="tab" data-target="groups-panel">
            Groups
          </li><li id="victims-tab" class="tab" data-target="users-panel">
            Users
          </li><li id="calendar-tab" class="tab" data-target="calendar-panel">
            Calendar Setup
          </li>
        </ul><div id="admin-function-container" class="tab-panel-container">
          <div id="config-panel" class="tab-panel active-panel">
            <div id="config-panel-buttons" class="tab-panel-buttons">
              <button id="config-edit" class="elegant_icons icon_pencil-edit"></button>
            </div>
            <div id="config-panel-data" class="tab-panel-data"></div>
          </div>
          <div id="groups-panel" class="tab-panel">
            <div id="groups-panel-data" class="tab-panel-data"></div>
          </div>
          <div id="users-panel" class="tab-panel">
            <div id="users-panel-buttons" class="tab-panel-buttons">
              <button id="users-add" class="elegant_icons icon_plus_alt2"></button>
              <button id="users-delete" class="elegant_icons icon_minus_alt2"></button>
            </div>
            <div id="users-panel-data" class="tab-panel-data"></div>
          </div>
          <div id="calendar-panel" class="tab-panel">
            <div id="calendar-panel-buttons" class="tab-panel-buttons"></div>
            <div id="calendar-panel-data" class="tab-panel-data"></div>
          </div>
        </div>
      </div>
    </div>
    <div id="create-config-popup" class="popup mfp-hide">
      <h3>Create/Correct OnCalendar Config</h3>
      <div id="config-popup-data">
        <table id="config-popup-table" class="admin-table">
          <tr class="config-item">
            <th class="config-key">DB Host</th>
            <td id="config-popup-dbhost" class="config-value">
              <input type="text" id="config-popup-dbhost-input" name="DBHOST" value="">
            </td>
          </tr>
          <tr class="config-item">
            <th class="config-key">DB User</th>
            <td id="config-popup-dbuser" class="config-value">
              <input type="text" id="config-popup-dbuser-input" name="DBUSER" value="">
            </td>
          </tr>
          <tr class="config-item">
            <th class="config-key">DB Password</th>
            <td id="config-popup-dbpassword" class="config-value">
              <input type="password" id="config-popup-dbpassword-input" name="DBPASSWORD" value="">
            </td>
          </tr>
          <tr class="config-item">
            <td class="config-key">Reenter password</td>
            <td id="config-popup-confirm-dbpassword" class="config-value">
              <input type="password" id="config-popup-dbpassword-confirm-input" name="dbpassword-config" value="">
            </td>
          </tr>
          <tr class="config-item">
            <th class="config-key">DB Name</th>
            <td id="config-popup-dbname" class="config-value">
              <input type="text" id="config-popup-dbname-input" name="DBNAME" value="">
            </td>
          </tr>
          <tr id="config-popup-edit-buttons" class="config-item">
            <td><button id="cancel-config-popup-edit">Cancel</button></td>
            <td><button id="save-config-popup-edit">Save</button></td>
          </tr>
        </table>
      </div>
    </div>
    <div id="create-db-popup" class="popup mfp-hide">
      <h3>Database does not exist</h3>
      <p>If you have credentials that allow you to create databases in your
      MySQL instance enter them here to create the OnCalendar database.</p>
      <p>If you don't have permissions to create the database yourself, ask
      your database administrator to create a database for OnCalendar and give
      the oncalendar user ownership of it.</p>
      <div id="create-db-mysql-credentials">
        <table id="create-db-credentials-table" class="admin-table">
          <tr class="config-item">
            <th class="config-key">MySQL User</th>
            <td class="config-value"><input type="text" id="create-db-user-input" name="create-db-user" value=""></td>
          </tr>
          <tr class="config-item">
            <th class="config-key">Password</th>
            <td class="config-value"><input type="password" id="create-db-password-input" name="create-db-password" value=""></td>
          </tr>
          <tr class="config-item">
            <th></th>
            <td><button id="create-db-button">Create Database</button></td>
          </tr>
        </table>
      </div>
    </div>
    <div id="init-db-prompt-popup" class="popup mfp-hide">
      <h3>Database has not been initialized.</h3>
      <div id="db-init-prompt">
        <p>Initialize now?</p>
        <input type="hidden" id="init-db-force" name="init-db-force" value="no">
        <button id="init-db-button" onClick="oncalendar_admin.initialize_db()">Yes</button>
      </div>
    </div>
    <div id="add-group-popup" class="popup mfp-hide">
      <table id="add-group-table" class="admin-table">
        <tr>
          <th>Group Name</th>
          <th>Active</th>
          <th>Autorotate</th>
          <th>Turnover Day</th>
          <th>Turnover Time</th>
          <th>Email</th>
          <th>Shadow</th>
          <th>Backup</th>
          {% if email_gateway_config == 'true' %}
          <th>Failsafe</th>
          <th>Oncall Alias</th>
          <th>Backup Alias</th>
          <th>Failsafe Alias</th>
          {% endif %}
        </tr>
        <tr>
          <td><input type="text" id="new-group-name" name="new-group-name"></td>
          <td>
            <button id="new-group-active-checkbox" class="oc-checkbox elegant_icons icon_box-checked" data-target="new-group-active" data-checked="yes"></button>
            <input type="hidden" id="new-group-active" name="new-group-active" value="1">
          </td>
          <td>
            <button id="new-group-autorotate-checkbox" class="oc-checkbox elegant_icons icon_box-checked" data-target="new-group-autorotate" data-checked="yes"></button>
            <input type="hidden" id="new-group-autorotate" name="new-group-autorotate" value="1">
          </td>
          <td>
            <span id="new-group-turnover-day-menu" class="dropdown">
              <span data-toggle="dropdown">
                <button id="new-group-turnover-day-label">Monday <span class="elegant_icons arrow_carrot-down"></span></button>
              </span>
	          <ul id="new-group-turnover-day-options" class="dropdown-menu" role="menu">
	            <li data-day="1"><span>Monday</span></li>
	            <li data-day="2"><span>Tuesday</span></li>
	            <li data-day="3"><span>Wednesday</span></li>
	            <li data-day="4"><span>Thursday</span></li>
	            <li data-day="5"><span>Friday</span></li>
	            <li data-day="6"><span>Saturday</span></li>
	            <li data-day="7"><span>Sunday</span></li>
	          </ul>
            </span>
            <input type="hidden" id="new-group-turnover-day" name="new-group-turnover-day" value="1">
          </td>
          <td>
            <span id="new-group-turnover-hour-menu" class="dropdown">
              <span data-toggle="dropdown">
	              <button id="new-group-turnover-hour-label">09 <span class="elegant_icons arrow_carrot-down"></span></button>
              </span>
	          <ul id="new-group-turnover-hour-options" class="dropdown-menu" role="menu">
	            <li data-hour="00"><span>00</span></li>
	            <li data-hour="01"><span>01</span></li>
	            <li data-hour="02"><span>02</span></li>
	            <li data-hour="03"><span>03</span></li>
	            <li data-hour="04"><span>04</span></li>
	            <li data-hour="05"><span>05</span></li>
	            <li data-hour="06"><span>06</span></li>
	            <li data-hour="07"><span>07</span></li>
	            <li data-hour="08"><span>08</span></li>
	            <li data-hour="09"><span>09</span></li>
	            <li data-hour="10"><span>10</span></li>
	            <li data-hour="11"><span>11</span></li>
	            <li data-hour="12"><span>12</span></li>
	            <li data-hour="13"><span>13</span></li>
	            <li data-hour="14"><span>14</span></li>
	            <li data-hour="15"><span>15</span></li>
	            <li data-hour="16"><span>16</span></li>
	            <li data-hour="17"><span>17</span></li>
	            <li data-hour="18"><span>18</span></li>
	            <li data-hour="19"><span>19</span></li>
	            <li data-hour="20"><span>20</span></li>
	            <li data-hour="21"><span>21</span></li>
	            <li data-hour="22"><span>22</span></li>
	            <li data-hour="23"><span>23</span></li>
	          </ul>
            </span>
            <input type="hidden" id="new-group-turnover-hour" name="new-group-turnover-hour" value="09">
            :<span id="new-group-turnover-min-menu" class="dropdown">
              <span data-toggle="dropdown">
                <button id="new-group-turnover-min-label">30 <span class="elegant_icons arrow_carrot-down"></span></button>
              </span>
	          <ul id="new-group-turnover-min-options" class="dropdown-menu" role="menu">
	            <li data-min="00"><span>00</span></li>
	            <li data-min="30"><span>30</span></li>
	          </ul>
            </span>
            <input type="hidden" id="new-group-turnover-min" name="new-group-turnover-min" value="30">
          </td>
          <td><input type="text" id="new-group-email" name="new-group-email"></td>
          <td>
            <button id="new-group-shadow-checkbox" class="oc-checkbox elegant_icons icon_box-empty" data-target="new-group-shadow" data-checked="no"></button>
            <input type="hidden" id="new-group-shadow" name="new-group-shadow" value="0">
          </td>
          <td>
            <button id="new-group-backup-checkbox" class="oc-checkbox elegant_icons icon_box-empty" data-target="new-group-backup" data-checked="no"></button>
            <input type="hidden" id="new-group-backup" name="new-group-backup" value="0">
          </td>
          {% if email_gateway_config == 'true' %}
          <td>
            <button id="new-group-failsafe-checkbox" class="oc-checkbox elegant_icons icon_box-empty" data-target="new-group-failsafe" data-check="no"></button>
            <input type="hidden" id="new-group-failsafe" name="new-group-failsafe" value="0">
          </td>
          <td><input type="text" id="new-group-alias" name="new-group-alias"></td>
          <td><input type="text" id="new-group-backup-alias" name="new-group-backup-alias"></td>
          <td><input id="new-group-failsafe-alias" name="new-group-failsafe-alias"></td>
          {% endif %}
        </tr>
      </table>
      <div id="new-group-action-buttons">
        <button id="cancel-add-group-button">Cancel</button>
        <button id="save-add-group-button">Save</button>
      </div>
    </div>
    <div id="delete-groups-confirm-popup" class="popup mfp-hide">
      <h3>Are you sure?</h3>
      <div id="delete-groups-confirm">
        <p>The following groups will be deleted:</p>
        <p id="delete-groups-list"></p>
        <button id="delete-groups-cancel-button">Cancel</button>
        <button id="delete-groups-confirm-button">Delete</button>
      </div>
    </div>
    <div id="delete-victims-confirm-popup" class="popup mfp-hide">
      <h3>Are you sure?</h3>
      <div id="delete-victims-confirm">
        <p>The following users will be deleted:</p>
        <p id="delete-victims-list"></p>
        <button id="delete-victims-cancel-button">Cancel</button>
        <button id="delete-victims-confirm-button">Delete</button>
      </div>
    </div>
    <script type="text/javascript">
      {{ main_js|safe }}
    </script>
  </body>
</html>